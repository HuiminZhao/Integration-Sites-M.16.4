#Modules
import numpy as np
import pandas as pd
from Bio import SeqIO
from Bio.Seq import Seq
import re

#Data
df = pd.read_excel('data/m_16_4/Selected_sites.xlsx')
print(df.head())

lacS_cassette = 'CTCCTCTTATTATTAGAATTGTACGCTATATTTTTTGCAAATTATTTTAACATGTTATGTTTCATAATAATTTTATTGTTTTTCTCTATATCAATCTCTTTTTGAAAGTGCTAATATTATATCTTTCAAATGAAATAATTTGGTGAAACACCACTGAAGATACTCGCTCAAAGCTTAAATAATATTAATCATAAATAAAGTCATGTACTCATTTCCAAATAGCTTTAGGTTTGGTTGGTCCCAGGCCGGATTTCAATCAGAAATGGGAACACCAGGGTCAGAAGATCCAAATACTGACTGGTATAAATGGGTTCATGATCCAGAAAACATGGCAGCGGGATTAGTAAGTGGAGATCTACCAGAAAATGGGCCAGGCTACTGGGGAAACTATAAGACATTTCACGATAATGCACAAAAAATGGGATTAAAAATAGCTAGACTAAATGTGGAATGGTCTAGGATATTTCCTAATCCATTACCAAGGCCACAAAACTTTGATGAATCAAAACAAGATGTGACAGAGGTTGAGATAAACGAAAACGAGTTAAAGAGACTTGACGAGTACGCTAATAAAGACGCATTAAACCATTACAGGGAAATATTCAAGGATCTTAAAAGTAGAGGACTTTACTTTATACTAAACATGTATCATTGGCCATTACCTCTATGGTTACACGACCCAATAAGAGTAAGAAGAGGAGATTTTACTGGACCAAGTGGTTGGCTAAGTACTAGAACAGTTTACGAATTCGCTAGATTCTCAGCTTATATAGCTTGGAAATTCGATGATCTAGTGGATGAGTACTCAACAATGAATGAACCTAACGTTGTTGGAGGTTTAGGATACGTTGGTGTTAAGTCCGGTTTTCCCCCAGGATACCTAAGCTTTGAACTTTCCCGTAGGGCAATGTATAACATCATTCAAGCTCACGCAAGAGCGTATGATGGGATAAAGAGTGTTTCTAAAAAACCAGTTGGAATTATTTACGCTAATAGCTCATTCCAGCCGTTAACGGATAAAGATATGGAAGCGGTAGAGATGGCTGAAAATGATAATAGATGGTGGTTCTTTGATGCTATAATAAGAGGTGAGATCACCAGAGGAAACGAGAAGATTGTAAGAGATGACCTAAAGGGTAGATTGGATTGGATTGGAGTTAATTATTACACTAGGACTGTTGTGAAGAGGACTGAAAAGGGATACGTTAGCTTAGGAGGTTACGGTCACGGATGTGAGAGGAATTCTGTAAGTTTAGCGGGATTACCAACCAGCGACTTCGGCTGGGAGTTCTTCCCAGAAGGTTTATATGACGTTTTGACGAAATACTGGAATAGATATCATCTCTATATGTACGTTACTGAAAATGGTATTGCGGATGATGCCGATTATCAAAGGCCCTATTATTTAGTATCTCACGTTTATCAAGTTCATAGAGCAATAAATAGTGGTGCAGATGTTAGAGGGTATTTACATTGGTCTCTAGCTGATAATTACGAATGGGCTTCAGGATTCTCTATGAGGTTTGGTCTGTTAAAGGTCGATTACAACACTAAGAGACTATACTGGAGACCCTCAGCACTAGTATATAGGGAAATCGCCACAAATGGCGCAATAACTGATGAAATAGAGCACTTAAATAGCGTACCTCCAGTAAAGCCATTAAGGCACTAAACTTTCTCAAGTCTCACTATACCAAATGAGTTTTCTTTTAATCTTATTCTAATCTCATTTTCATTAGATTGCAATACTTTCATACCTTCTATATTATTTATTTTGTACCTTTTGGGATCTACACTTAATGTTAGCCTAATTGGAAAGTCATTTAGATTTAATACTGTTACCAGTCCATCCCTTTTAATTATTAATGAAAATAAGAAGGGATAAGTAGCGATAGCCCTTATTCCGATATGGTCTCCAACAATATCCCTTATTATCTGCCTTGCAACACTAGG'
SalI = 'GTCGAC'
FseI = 'GGCCGGCC'
SbfI = 'cctgcagg'
NotI = 'GCGGCCGC'

folder_path = 'data/m_16_4/'
ofile = open(folder_path + 'TWIST.fa', "w")

for i in range(len(df)):
    insert = SalI + df['Left HR'][i] + FseI + lacS_cassette + SbfI + df['Right HR'][i] + NotI
    ofile.write(">" + str(df['ID'][i]) + "\n" + insert + "\n")

ofile.close()

